# 📝 要件定義書：予定リマインダーアプリ（メール通知版）

## 1. 概要

本システムは，家庭内に設置された Raspberry Pi 5 上の Apache2 サーバーで稼働する，個人向けの予定リマインダーアプリである．予定を登録し，指定時刻になるとメールで通知する機能を提供する．

## 2. 目的

- ユーザーが事前に登録した予定に対して，リマインド時刻にメールで通知を行う
- 家庭内での利用を前提とし，初期段階では1人ユーザーのみ対応
- 将来的なLINE通知やマルチユーザー対応の拡張も視野に入れた設計とする

## 3. システム構成

- **設置場所**：家庭内サーバー（Raspberry Pi 5）
- **稼働環境**：
  - OS：Raspberry Pi OS または Ubuntu Server
  - Webサーバー：Apache2（mod_wsgi利用）
  - バックエンド：Python3 + Flask（または FastAPI）
  - データベース：SQLite3（軽量で組込み向き）

## 4. 機能要件

### 4.1 予定登録機能
- 入力項目：
  - タイトル
  - 詳細説明（任意）
  - 実行日時
  - リマインド通知時刻
- Webフォームから登録
- 将来的に繰り返し予定対応も視野に入れる

### 4.2 一覧表示／編集機能
- 登録された予定を一覧で表示（時系列順）
- 各予定の編集／削除が可能

### 4.3 通知機能（メール）
- 指定した「リマインド時刻」になると，登録されたメールアドレスに通知を送信
- メール本文にはタイトル・日時・備考を記載

### 4.4 通知設定機能
- メールアドレスをあらかじめ設定（ユーザー情報に紐づけ）
- 通知方式として「メールのみ」使用（LINEは今後対応）

### 4.5 スケジューラ処理
- APScheduler などを用いて一定間隔で予定テーブルを監視し，通知を実行
- サーバー起動時に自動起動（systemdなどを利用）

## 5. 非機能要件

| 項目             | 内容                                          |
|------------------|-----------------------------------------------|
| 使用者数         | 初期段階では1人（将来の多人数対応に備えた設計） |
| 時刻管理         | NTPで時刻同期して正確なリマインドを保証        |
| 通知の正確性     | 秒単位の精度は求めず，分単位での通知で良い     |
| 保守性           | コードは拡張性を考慮し，通知処理などをモジュール化 |
| セキュリティ     | ローカルLAN内のみで利用するため認証は省略可     |
| ログ出力         | 通知履歴やエラーはログファイルに出力する       |

## 6. データベース設計（簡易）

### users テーブル（将来の多人数対応に備えて作成）

| フィールド     | 型       | 説明              |
|----------------|----------|-------------------|
| user_id        | INTEGER  | 主キー            |
| name           | TEXT     | ユーザー名        |
| email          | TEXT     | 通知先メールアドレス |

### events テーブル

| フィールド       | 型       | 説明                    |
|------------------|----------|-------------------------|
| event_id         | INTEGER  | 主キー                  |
| user_id          | INTEGER  | users.user_id に外部キー |
| title            | TEXT     | 予定のタイトル          |
| description      | TEXT     | 詳細説明（任意）        |
| event_datetime   | DATETIME | 実行予定日時            |
| remind_datetime  | DATETIME | 通知予定日時            |
| notified         | BOOLEAN  | 通知済みフラグ           |

## 7. 将来拡張

- LINE通知機能の追加（Messaging APIを用いる）
- ユーザー認証機能（多人数対応時に導入）
- 繰り返し予定のサポート（毎週・毎月など）
- モバイルPWA対応（ホーム画面追加・オフライン対応）

